S∆† ƒê·ªí (4): LU·ªíNG API THEO NGHI·ªÜP V·ª§ ‚Äì H·ªÜ TH·ªêNG CTVT3
(B·∫£n chu·∫©n tri·ªÉn khai ‚Äì kh√≥a logic h·ªá th·ªëng)
________________________________________
I. M·ª§C ƒê√çCH S∆† ƒê·ªí (4)
S∆° ƒë·ªì (4) tr·∫£ l·ªùi 5 c√¢u h·ªèi s·ªëng c√≤n:
1. M·ªói nghi·ªáp v·ª• g·ªçi API n√†o
2. API ƒë∆∞·ª£c ph√©p ghi v√†o b·∫£ng n√†o
3. API sinh ra nh·ªØng h·ªá qu·∫£ g√¨
4. API n√†o TUY·ªÜT ƒê·ªêI KH√îNG ƒë∆∞·ª£c s·ª≠a s·ªë
5. Tr√¨nh t·ª± x·ª≠ l√Ω ƒë·ªÉ kh√¥ng sai k·∫ø to√°n
‚ùó Sau s∆° ƒë·ªì n√†y:
‚Ä¢	Kh√¥ng c√≥ API ‚Äúti·ªán tay update‚Äù
‚Ä¢	Kh√¥ng c√≥ chuy·ªán ‚Äút√≠nh l·∫°i cho nhanh‚Äù
________________________________________
II. NGUY√äN T·∫ÆC CHUNG C·ª¶A API CTVT3
1. API ch·ªâ ph·ª•c v·ª• NGHI·ªÜP V·ª§ (theo S∆° ƒë·ªì 1)
2. API ch·ªâ ghi v√†o CORE_GIAO_DICH
3. NHAT_KY v√† CHOT sinh T·ª∞ ƒê·ªòNG
4. API ƒë·ªçc b√°o c√°o KH√îNG ghi DB
5. Kh√¥ng API n√†o ƒë∆∞·ª£c s·ª≠a s·ªë d∆∞ tr·ª±c ti·∫øp
________________________________________
III. LU·ªíNG API THEO T·ª™NG NGHI·ªÜP V·ª§
________________________________________
(1) QU·∫¢N L√ù DANH M·ª§C
API
POST   /dm/khach-hang
PUT    /dm/khach-hang/{id}

POST   /dm/nha-cung-cap
POST   /dm/nhan-vien
POST   /dm/kho
POST   /dm/san-pham
Ghi DB
khach_hang
nha_cung_cap
nhan_vien
kho_hang
san_pham
nhan_vien_kho
C·∫§M
- Kh√¥ng ghi kho
- Kh√¥ng ghi ti·ªÅn
- Kh√¥ng ghi c√¥ng n·ª£
________________________________________
(2) NH·∫¨P GAS
API
POST /nhap-gas/hoa-don
POST /nhap-gas/hoa-don/{id}/chi-tiet
POST /nhap-gas/{id}/xac-nhan
Ghi DB (CORE)
hoa_don_nhap
hoa_don_nhap_chi_tiet
hoa_don_vat (n·∫øu c√≥)
Sinh t·ª± ƒë·ªông
nhat_ky_kho (nhap)
nhat_ky_vo (n·∫øu c√≥)
·∫¢nh h∆∞·ªüng
- TƒÉng t·ªìn kho (t√≠nh sau)
- Ph√°t sinh c√¥ng n·ª£ NCC
- Gi·∫£m qu·ªπ (n·∫øu thanh to√°n)
________________________________________
(3) B√ÅN GAS ‚≠ê
API
POST /ban-gas/hoa-don
POST /ban-gas/hoa-don/{id}/chi-tiet
POST /ban-gas/{id}/xac-nhan
Ghi DB
hoa_don_ban
hoa_don_ban_chi_tiet
gas_du (n·∫øu b√°n kg)
hoa_don_vat (n·∫øu c√≥)
Sinh t·ª± ƒë·ªông
nhat_ky_kho (xuat)
nhat_ky_vo
·∫¢nh h∆∞·ªüng
- Gi·∫£m t·ªìn kho
- TƒÉng ti·ªÅn (NV / c√¥ng ty)
- Ph√°t sinh c√¥ng n·ª£ kh√°ch
- Ph√°t sinh VAT ƒë·∫ßu ra
________________________________________
(4) THU ‚Äì CHI PH√ÅT SINH
API
POST /thu-chi/thu
POST /thu-chi/chi
Ghi DB
thu_chi
hoa_don_vat (n·∫øu c√≥)
·∫¢nh h∆∞·ªüng
- Qu·ªπ nh√¢n vi√™n
- Qu·ªπ c√¥ng ty
- C√≥ th·ªÉ li√™n quan c√¥ng n·ª£
________________________________________
(5) THU NG√ÇN (NV N·ªòP TI·ªÄN)
API
POST /thu-ngan/nop-tien
Ghi DB
thu_ngan
·∫¢nh h∆∞·ªüng
- Gi·∫£m qu·ªπ NV
- TƒÉng qu·ªπ c√¥ng ty
‚ùó Kh√¥ng sinh doanh thu.
________________________________________
(6) ƒê·∫∂T H√ÄNG
(6.1) Kh√°ch ƒë·∫∑t tr∆∞·ªõc
API
POST /dat-hang/khach
Ghi DB
thu_chi (thu)
hoa_don_vat (n·∫øu c√≥)
________________________________________
(6.2) ƒê·∫∑t NCC
API
POST /dat-hang/ncc
Ghi DB
thu_chi (chi)
hoa_don_vat (n·∫øu c√≥)
________________________________________
(7) QU·∫¢N L√ù T·ªîNG H·ª¢P ‚Äì ƒê·ªêI SO√ÅT
API
GET /bao-cao/cong-no
GET /bao-cao/ton-kho
GET /bao-cao/loi-nhuan
DB
READ ONLY
‚ùå C·∫§M
INSERT / UPDATE / DELETE
________________________________________
(8) K·∫æ TO√ÅN D·ªäCH V·ª§ ‚Äì C√ÇN THU·∫æ VAT
API
POST /ke-toan/can-thue
Ghi DB
hoa_don_vat (loai = can_thue)
·∫¢nh h∆∞·ªüng
- Ph√°t sinh VAT ph·∫£i n·ªôp
- Kh√¥ng ·∫£nh h∆∞·ªüng kho
- Kh√¥ng ·∫£nh h∆∞·ªüng l·ª£i nhu·∫≠n NV
________________________________________
IV. API H·ªÜ TH·ªêNG (L·ªöP H)
API
POST /auth/login
POST /auth/logout
GET  /auth/me

POST /chat/phong
POST /chat/tin-nhan
Ghi DB
user
user_session
phong_chat
tin_nhan
audit_log
‚ùó KH√îNG JOIN ‚Äì KH√îNG T√çNH S·ªê
________________________________________
V. NH·ªÆNG API B·ªä C·∫§M TUY·ªÜT ƒê·ªêI
PUT /ton-kho
PUT /cong-no
PUT /quy
PUT /bao-cao/*
üëâ N·∫øu c·∫ßn ƒëi·ªÅu ch·ªânh ‚Üí t·∫°o ch·ª©ng t·ª´ m·ªõi.
________________________________________
VI. LU·ªíNG T·ªîNG QU√ÅT (D·∫†NG CH·ªÆ ‚Äì ƒê·ªÇ V·∫º)
[API nghi·ªáp v·ª•]
        ‚Üì
[CORE_GIAO_DICH]
        ‚Üì
[Service sinh h·ªá qu·∫£]
        ‚Üì
[NHAT_KY]
        ‚Üì
[JOB ch·ªët k·ª≥]
        ‚Üì
[BAO_CAO]
________________________________________
VII. NGUY√äN T·∫ÆC KH√ìA CU·ªêI C√ôNG
1. API kh√¥ng t√≠nh ‚Äì ch·ªâ ghi s·ª± ki·ªán
2. S·ªë li·ªáu lu√¥n t√≠nh t·ª´ CORE
3. B√°o c√°o kh√¥ng ƒë∆∞·ª£c ghi
4. ƒêi·ªÅu ch·ªânh = ch·ª©ng t·ª´ m·ªõi
5. Dev kh√¥ng c√≥ quy·ªÅn s·ª≠a s·ªë
________________________________________
VIII. T√äN FILE CHU·∫®N
04_LUONG_API_THEO_NGHIEP_VU_CTVT3__CHUAN.txt

